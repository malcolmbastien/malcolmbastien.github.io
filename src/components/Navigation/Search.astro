---
---
<div id="search-container" class="w-full">
    <div id="search-box"></div>
</div>

<script is:inline>
  function initSearch() {
    if (typeof PagefindUI !== 'undefined') {
        new PagefindUI({
            element: "#search-box",
            showSubResults: true,
            translations: {
                placeholder: "Search the garden..."
            }
        });

        // Auto-focus the search input
        setTimeout(() => {
            const searchInput = document.querySelector(".pagefind-ui__search-input");
            if (searchInput) {
                searchInput.focus();
            }
        }, 100);
    } else {
        const container = document.querySelector("#search-box");
        if (container) {
            container.innerHTML = `
                <div class="text-sm text-secondary p-4 text-center border border-dashed border-slate-200 dark:border-slate-800 rounded-lg">
                    Search available after build
                </div>
            `;
        }
    }
  }

  window.addEventListener('DOMContentLoaded', initSearch);
</script>

<style is:global>
  @reference "../../styles/global.css";

  :root {
    --pagefind-ui-primary: #10b981;
    --pagefind-ui-text: #1e293b;
    --pagefind-ui-background: #ffffff;
    --pagefind-ui-border: #e2e8f0;
    --pagefind-ui-tag: #f1f5f9;
    --pagefind-ui-width: 100%;
  }

  .dark {
    --pagefind-ui-primary: #10b981;
    --pagefind-ui-text: #f8fafc;
    --pagefind-ui-background: #0f172a;
    --pagefind-ui-border: #1e293b;
    --pagefind-ui-tag: #1e293b;
  }

  #search-box {
    width: 100%;
    max-width: none;
  }

  .pagefind-ui,
  .pagefind-ui__form,
  .pagefind-ui__drawer,
  .pagefind-ui__results,
  .pagefind-ui__result {
    max-width: none !important;
    width: 100% !important;
  }

  #search-box .pagefind-ui__search-input {
    @apply border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 text-xl focus:ring-4 focus:ring-green-500/5 focus:border-green-500 transition-all py-5 px-14;
    border-radius: 1rem;
  }

  /* Search Icon override */
  #search-box .pagefind-ui__search-input::placeholder {
    @apply text-slate-400;
  }

  #search-box .pagefind-ui__result-link {
    @apply text-navy-900 dark:text-white font-sans font-bold hover:text-green-500 dark:hover:text-green-600 transition-colors text-2xl tracking-tight leading-tight;
  }

  #search-box .pagefind-ui__result-nested .pagefind-ui__result-link {
    @apply flex items-center gap-2 text-sm font-bold text-slate-700 dark:text-slate-300 hover:text-green-500 dark:hover:text-green-600 transition-colors;
  }

  #search-box .pagefind-ui__result-excerpt {
    @apply text-slate-600 dark:text-slate-400 text-[17px] mt-4 font-serif leading-relaxed;
  }

  #search-box .pagefind-ui__result {
    @apply flex flex-col sm:flex-row gap-8 pb-16 mb-16 border-b border-slate-200 dark:border-slate-800 last:border-0;
  }

  #search-box .pagefind-ui__result-thumb {
    @apply shrink-0 w-32 h-32 rounded-2xl overflow-hidden bg-slate-100 dark:bg-slate-800 shadow-sm m-0!;
  }

  #search-box .pagefind-ui__result-inner {
    @apply flex-1 flex flex-col gap-2;
  }

  #search-box .pagefind-ui__message {
    @apply text-sm font-medium text-slate-500 pb-6 border-b border-slate-200 dark:border-slate-800 mb-8;
  }

  #search-box .pagefind-ui__drawer {
    @apply mt-8;
  }

  #search-box .pagefind-ui__result-title {
    @apply text-navy-900 dark:text-white font-sans font-bold;
  }

  #search-box .pagefind-ui__result-nested {
    @apply mt-6 space-y-4 ml-0!;
  }

  #search-box .pagefind-ui__result-nested .pagefind-ui__result-link::before {
    content: "subdirectory_arrow_right";
    font-family: 'Material Icons Round';
    @apply text-base text-slate-400 font-normal;
  }

  #search-box .pagefind-ui__result-nested .pagefind-ui__result-excerpt {
    @apply pl-7 text-sm text-slate-500 font-serif leading-relaxed mt-1;
  }

  #search-box .pagefind-ui__button {
    @apply bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl text-sm font-bold text-slate-500 hover:bg-slate-50 dark:hover:bg-slate-800 transition-all py-3;
  }

  /* Stage-based accent styling */
  .result-evergreen { border-left: 4px solid var(--color-evergreen) !important; padding-left: 1.5rem !important; }
  .result-sprout { border-left: 4px solid var(--color-sprout) !important; padding-left: 1.5rem !important; }
  .result-seed { border-left: 4px solid var(--color-seed) !important; padding-left: 1.5rem !important; }

  .result-evergreen .pagefind-ui__result-link { @apply text-green-600 dark:text-green-600; }
  .result-sprout .pagefind-ui__result-link { @apply text-lime-600 dark:text-lime-600; }
  .result-seed .pagefind-ui__result-link { @apply text-amber-600 dark:text-amber-600; }

  .result-evergreen .pagefind-ui__result-tag { @apply bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-600 border border-green-100 dark:border-green-800/50; }
  .result-sprout .pagefind-ui__result-tag { @apply bg-lime-100 dark:bg-lime-900/30 text-lime-600 dark:text-lime-600 border border-lime-100 dark:border-lime-800/50; }
  .result-seed .pagefind-ui__result-tag { @apply bg-amber-100 dark:bg-amber-900/30 text-amber-600 dark:text-amber-600 border border-amber-100 dark:border-amber-800/50; }
</style>
