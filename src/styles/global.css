@import "tailwindcss";
@plugin "@tailwindcss/typography";

@theme {
  --color-primary: #2563eb;
  
  /* Typographic Ledger - Paper Tones */
  --color-background-light: #fdfdfd;
  --color-background-dark: #0f172a;
  --color-content-light: #ffffff;
  --color-content-dark: #1e293b;
  --color-paper: #fdfdfd;
  --color-paper-dark: #0f172a;
  --color-ink: #0f172a;
  --color-ink-dark: #f1f5f9;

  /* Garden Stage Colors */
  --color-garden-seed: #fef3c7;
  --color-garden-sprout: #dcfce7;
  --color-garden-evergreen: #ecfdf5;
  --color-garden-seed-border: #f59e0b;
  --color-garden-sprout-border: #22c55e;
  --color-garden-evergreen-border: #10b981;
  --color-navy-800: #1e293b;
  --color-navy-900: #0f172a;

  /* Typography System - All Sans-Serif */
  --font-display: "Inter", system-ui, sans-serif;
  --font-serif: "Inter", system-ui, sans-serif;
  --font-mono: "JetBrains Mono", "Roboto Mono", monospace;
  
  /* Ledger Spacing */
  --ledger-baseline: 1.75rem;
  --ledger-section-gap: 3rem;
  --ledger-content-width: 720px;

  --color-blueprint-blue: #4382ff;
  --color-terminal-dark: #0f172a;
  --color-canvas-white: #f8fafc;
  --color-tooling-gray: #f1f5f9;

  --color-seed: #f59e0b;
  --color-sprout: #84cc16;
  --color-evergreen: #22c55e;

  /* Stage Underline Colors */
  --stage-seed-underline: #fbbf24;
  --stage-sprout-underline: #a3e635;
  --stage-evergreen-underline: #16a34a;

  --color-andon-amber: #f59e0b;
  --color-sprout-teal: #84cc16;
  --color-evergreen-green: #22c55e;
  --color-andon-emerald: #22c55e;
  --color-neutral-text-light: #64748b;
  --color-neutral-text-dark: #f8fafc;
  --color-neutral-metadata-dark: #cbd5e1;
  --shadow-blueprint: 0 0 8px rgba(59, 130, 246, 0.5);
  --shadow-blueprint-hover: 0 10px 30px -5px rgba(59, 130, 246, 0.3);

  --font-sans: var(--font-display);
}

/* Enable class-based dark mode for Tailwind 4 */
@custom-variant dark (&:is(.dark, .dark *));

@utility no-scrollbar {
  -ms-overflow-style: none;
  scrollbar-width: none;
  &::-webkit-scrollbar {
    display: none;
  }
}

/* --- Masonry Image Gallery --- */
.photo-gallery {
  display: block !important;
  column-count: 1;
  column-gap: 1.5rem;
  margin-top: 3rem;
  margin-bottom: 3rem;
}

@media (min-width: 640px) {
  .photo-gallery { column-count: 2; }
}

@media (min-width: 1024px) {
  .photo-gallery { column-count: 3; }
}

.gallery-item {
  display: block;
  margin-bottom: 1.5rem;
  break-inside: avoid;
}

.gallery-item img {
  width: 100% !important;
  height: auto !important;
  display: block !important;
  border-radius: 0.75rem !important;
  border: 1px solid #f1f5f9 !important;
  box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1) !important;
  transition: box-shadow 0.3s !important;
  margin: 0 !important;
}

.dark .gallery-item img { border-color: #1e293b !important; }
.gallery-item img:hover { box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1) !important; }

.gallery-item em {
  display: block !important;
  font-style: normal !important;
  font-family: var(--font-display) !important;
  font-size: 11px !important;
  font-weight: 500 !important;
  text-transform: uppercase !important;
  letter-spacing: 0.05em !important;
  text-align: center !important;
  margin-top: 0.5rem !important;
  color: #64748b !important;
}

.dark .gallery-item em { color: #94a3b8 !important; }

/* --- Single Image & Caption Styling --- */
.prose p:has(img:only-of-type) {
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
  text-align: center !important;
  margin-top: 3rem !important;
  margin-bottom: 3rem !important;
}

.prose p img:only-of-type {
  border-radius: 0.75rem !important;
  border: 1px solid #f1f5f9 !important;
  margin: 0 !important;
  box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1) !important;
  transition: box-shadow 0.3s !important;
}

.dark .prose p img:only-of-type { border-color: #1e293b !important; }
.prose p img:only-of-type:hover { box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1) !important; }

.prose p:has(img:only-of-type) em {
  margin-top: 1rem !important;
  font-size: 0.875rem !important;
  color: #64748b !important;
  font-family: var(--font-display) !important;
  font-style: normal !important;
  display: block !important;
  line-height: 1.5 !important;
  max-width: 80% !important;
}

.dark .prose p:has(img:only-of-type) em { color: #94a3b8 !important; }

/* --- Core Layout & Typography --- */
html {
  overflow-y: scroll;
  font-family: "Inter", system-ui, sans-serif;
  background-color: var(--color-paper);
  color: var(--color-ink);
}

.no-transitions, .no-transitions *, .no-transitions *::after { transition: none !important; }

html.dark {
  background-color: var(--color-paper-dark);
  color: var(--color-ink-dark);
}

h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-display);
  font-weight: 700;
  letter-spacing: -0.02em;
  line-height: 1.2;
  color: var(--color-ink);
  @apply dark:text-ink-dark;
}

p { font-family: var(--font-serif); line-height: 1.75; }
.small-caps { font-variant: all-small-caps; letter-spacing: 0.1em; }
.tight-tracking { letter-spacing: -0.04em; }

@utility text-primary { @apply text-terminal-dark dark:text-neutral-text-dark; }
@utility text-secondary { @apply text-neutral-text-light dark:text-neutral-metadata-dark; }
@utility metadata { font-family: var(--font-mono); letter-spacing: 0.05em; text-transform: uppercase; }

/* --- Prose & Link Styling --- */
.prose a { @apply text-blueprint-blue hover:opacity-80 font-bold dark:font-extrabold; }
.prose a:hover { text-decoration: underline; text-underline-offset: 4px; }
.prose a.internal-link { @apply no-underline transition-all; display: inline; }
.prose a.internal-link[data-stage="seed"] { @apply text-slate-900 dark:text-white; }
.prose a.internal-link[data-stage="sprout"] { @apply text-slate-900 dark:text-white; }
.prose a.internal-link[data-stage="evergreen"] { @apply text-slate-900 dark:text-white; }

.prose a.external-link {
  @apply font-display font-semibold text-[#a855f7] hover:opacity-80 transition-opacity inline-flex items-center gap-1 no-underline;
}

.prose a.external-link::after {
  content: "north_east";
  font-family: "Material Symbols Outlined";
  font-size: 16px;
  line-height: 1;
  @apply ml-0 opacity-100;
}

.prose code:not(pre code) {
  @apply bg-slate-100 px-1.5 py-0.5 rounded text-sm font-mono font-medium;
  color: var(--color-terminal-dark);
}

.dark .prose code:not(pre code) {
  @apply bg-slate-900;
  color: var(--color-neutral-text-dark);
}

.prose code:not(pre code)::before, .prose code:not(pre code)::after { content: none; }

/* --- Refined Callouts (Horizontal Accent Style) --- */

.prose .markdown-alert {
  position: relative !important;
  padding-top: 0.5rem !important;
  margin: 3rem 0 !important;
  background: transparent !important;
  border: none !important;
  overflow: visible !important;
  width: 100% !important;
}

/* Horizontal Accent Divider */
.prose .markdown-alert::before {
  content: "" !important;
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  height: 1px !important;
  background-color: var(--alert-color, #475569) !important;
  opacity: 0.25 !important;
  display: block !important;
}

.prose .markdown-alert::after {
  content: "" !important;
  position: absolute !important;
  top: -1px !important;
  left: 0 !important;
  width: 64px !important;
  height: 4px !important;
  background-color: var(--alert-color, #475569) !important;
  display: block !important;
}

.prose .markdown-alert .markdown-alert-header {
  display: flex !important;
  align-items: center !important;
  gap: 0.5rem !important;
  margin: 0 0 0.5rem 0 !important;
}

.prose .markdown-alert .markdown-alert-icon {
  font-family: 'Material Symbols Outlined' !important;
  font-size: 18px !important;
  line-height: 1 !important;
  color: var(--alert-color, #475569) !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  font-variation-settings: "FILL" 1, "wght" 400, "GRAD" 0, "opsz" 20 !important;
}

.prose .markdown-alert .markdown-alert-title {
  font-family: var(--font-mono) !important;
  font-size: 10px !important;
  font-weight: 800 !important;
  text-transform: uppercase !important;
  letter-spacing: 0.1em !important;
  color: var(--alert-color, #475569) !important;
  line-height: 1 !important;
  font-style: normal !important;
}

.prose .markdown-alert .markdown-alert-content p {
  margin: 0 !important;
  font-family: "Source Serif 4", Georgia, serif !important;
  font-style: italic !important;
  font-size: 1.15rem !important;
  line-height: 1.65 !important;
  @apply text-slate-700 dark:text-slate-300;
}

/* Cleanup */
.prose .markdown-alert blockquote::before, 
.prose .markdown-alert blockquote::after,
.prose .markdown-alert p::before,
.prose .markdown-alert p::after { content: none !important; }

/* Color Palette Mappings - High Specificity to avoid inheritance issues */
.prose .markdown-alert.markdown-alert-note, 
.prose .markdown-alert.markdown-alert-quote, 
.prose .markdown-alert.markdown-alert-cite, 
.prose .markdown-alert.markdown-alert-draft, 
.prose .markdown-alert.markdown-alert-wip { --alert-color: #475569; }

.prose .markdown-alert.markdown-alert-abstract, 
.prose .markdown-alert.markdown-alert-summary, 
.prose .markdown-alert.markdown-alert-tldr,
.prose .markdown-alert.markdown-alert-tip,
.prose .markdown-alert.markdown-alert-idea { --alert-color: #2d5a27; }

.prose .markdown-alert.markdown-alert-info, 
.prose .markdown-alert.markdown-alert-todo { --alert-color: #1e3a8a; }

.prose .markdown-alert.markdown-alert-important, 
.prose .markdown-alert.markdown-alert-attention { --alert-color: #be123c; }

.prose .markdown-alert.markdown-alert-warning, 
.prose .markdown-alert.markdown-alert-caution { --alert-color: #b45309; }

.prose .markdown-alert.markdown-alert-failure, 
.prose .markdown-alert.markdown-alert-error, 
.prose .markdown-alert.markdown-alert-bug, 
.prose .markdown-alert.markdown-alert-danger { --alert-color: #ef4444; }

.prose .markdown-alert.markdown-alert-example, 
.prose .markdown-alert.markdown-alert-question { --alert-color: #7e22ce; }

/* Dark Mode Color Overrides */
.dark .prose .markdown-alert.markdown-alert-note { --alert-color: #94a3b8; }
.dark .prose .markdown-alert.markdown-alert-abstract, 
.dark .prose .markdown-alert.markdown-alert-tip,
.dark .prose .markdown-alert.markdown-alert-idea { --alert-color: #4ade80; }
.dark .prose .markdown-alert.markdown-alert-info { --alert-color: #60a5fa; }
.dark .prose .markdown-alert.markdown-alert-important { --alert-color: #fb7185; }
.dark .prose .markdown-alert.markdown-alert-warning { --alert-color: #facc15; }
.dark .prose .markdown-alert.markdown-alert-example { --alert-color: #c084fc; }

/* --- Filter Buttons --- */
.filter-btn {
  @apply px-3 py-1.5 text-sm font-medium transition-all;
  font-family: var(--font-mono);
  font-size: 11px;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  color: #737373;
  background: transparent;
  border: none;
  @apply dark:text-slate-400;
}

.filter-btn:hover { color: #262626; @apply dark:text-slate-200; }
.filter-btn.active { color: #1a1a1a; border-bottom: 1px solid #1a1a1a; @apply dark:text-white dark:border-white; }
