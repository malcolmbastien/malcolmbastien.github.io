@import "tailwindcss";
@plugin "@tailwindcss/typography";

@theme {
  --color-primary: #2563eb;
  
  /* Typographic Ledger - Paper Tones */
  --color-background-light: #fdfdfd;
  --color-background-dark: #0f172a;
  --color-content-light: #ffffff;
  --color-content-dark: #1e293b;
  --color-paper: #fdfdfd;
  --color-paper-dark: #0f172a;
  --color-ink: #0f172a;
  --color-ink-dark: #f1f5f9;

  /* Garden Stage Colors */
  --color-garden-seed: #fef3c7;
  --color-garden-sprout: #dcfce7;
  --color-garden-evergreen: #ecfdf5;
  --color-garden-seed-border: #f59e0b;
  --color-garden-sprout-border: #22c55e;
  --color-garden-evergreen-border: #10b981;
  --color-navy-800: #1e293b;
  --color-navy-900: #0f172a;

  /* Typography System - All Sans-Serif */
  --font-display: "Inter", system-ui, sans-serif;
  --font-serif: "Inter", system-ui, sans-serif;
  --font-mono: "JetBrains Mono", "Roboto Mono", monospace;
  
  /* Ledger Spacing */
  --ledger-baseline: 1.75rem;
  --ledger-section-gap: 3rem;
  --ledger-content-width: 720px;

  --color-blueprint-blue: #4382ff;
  --color-terminal-dark: #0f172a;
  --color-canvas-white: #f8fafc;
  --color-tooling-gray: #f1f5f9;

  --color-seed: #f59e0b;
  --color-sprout: #84cc16;
  --color-evergreen: #22c55e;

  /* Stage Underline Colors */
  --stage-seed-underline: #fbbf24;
  --stage-sprout-underline: #a3e635;
  --stage-evergreen-underline: #16a34a;

  --color-andon-amber: #f59e0b;
  --color-sprout-teal: #84cc16;
  --color-evergreen-green: #22c55e;
  --color-andon-emerald: #22c55e;
  --color-neutral-text-light: #64748b;
  --color-neutral-text-dark: #f8fafc;
  --color-neutral-metadata-dark: #cbd5e1;
  --shadow-blueprint: 0 0 8px rgba(59, 130, 246, 0.5);
  --shadow-blueprint-hover: 0 10px 30px -5px rgba(59, 130, 246, 0.3);

  --font-sans: var(--font-display);
}

/* Enable class-based dark mode for Tailwind 4 */
@custom-variant dark (&:is(.dark, .dark *));

@utility no-scrollbar {
  -ms-overflow-style: none;
  scrollbar-width: none;
  &::-webkit-scrollbar {
    display: none;
  }
}

/* --- Masonry Image Gallery --- */
.photo-gallery {
  display: block !important;
  column-count: 1;
  column-gap: 1.5rem;
  margin-top: 3rem;
  margin-bottom: 3rem;
}

@media (min-width: 640px) {
  .photo-gallery {
    column-count: 2;
  }
}

@media (min-width: 1024px) {
  .photo-gallery {
    column-count: 3;
  }
}

.gallery-item {
  display: block;
  margin-bottom: 1.5rem;
  break-inside: avoid;
}

.gallery-item img {
  width: 100% !important;
  height: auto !important;
  display: block !important;
  border-radius: 0.75rem !important;
  border: 1px solid #f1f5f9 !important;
  box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1) !important;
  transition: box-shadow 0.3s !important;
  margin: 0 !important;
}

.dark .gallery-item img {
  border-color: #1e293b !important;
}

.gallery-item img:hover {
  box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1) !important;
}

.gallery-item em {
  display: block !important;
  font-style: normal !important;
  font-family: var(--font-display) !important;
  font-size: 11px !important;
  font-weight: 500 !important;
  text-transform: uppercase !important;
  letter-spacing: 0.05em !important;
  text-align: center !important;
  margin-top: 0.5rem !important;
  color: #64748b !important;
}

.dark .gallery-item em {
  color: #94a3b8 !important;
}

/* --- Single Image & Caption Styling --- */
.prose p:has(img:only-of-type) {
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
  text-align: center !important;
  margin-top: 3rem !important;
  margin-bottom: 3rem !important;
}

.prose p img:only-of-type {
  border-radius: 0.75rem !important;
  border: 1px solid #f1f5f9 !important;
  margin: 0 !important;
  box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1) !important;
  transition: box-shadow 0.3s !important;
}

.dark .prose p img:only-of-type {
  border-color: #1e293b !important;
}

.prose p img:only-of-type:hover {
  box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1) !important;
}

.prose p:has(img:only-of-type) em {
  margin-top: 1rem !important;
  font-size: 0.875rem !important;
  color: #64748b !important;
  font-family: var(--font-display) !important;
  font-style: normal !important;
  display: block !important;
  line-height: 1.5 !important;
  max-width: 80% !important;
}

.dark .prose p:has(img:only-of-type) em {
  color: #94a3b8 !important;
}

/* --- Core Layout & Typography --- */
html {
  overflow-y: scroll;
  font-family: "Inter", system-ui, sans-serif;
  background-color: var(--color-paper);
  color: var(--color-ink);
}

.no-transitions,
.no-transitions *,
.no-transitions *::after {
  transition: none !important;
}

html.dark {
  background-color: var(--color-paper-dark);
  color: var(--color-ink-dark);
}

h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-display);
  font-weight: 700;
  letter-spacing: -0.02em;
  line-height: 1.2;
  color: var(--color-ink);
  @apply dark:text-ink-dark;
}

p {
  font-family: var(--font-serif);
  line-height: 1.75;
}

.small-caps {
  font-variant: all-small-caps;
  letter-spacing: 0.1em;
}

.tight-tracking {
  letter-spacing: -0.04em;
}

@utility text-primary {
  @apply text-terminal-dark dark:text-neutral-text-dark;
}

@utility text-secondary {
  @apply text-neutral-text-light dark:text-neutral-metadata-dark;
}

@utility metadata {
  font-family: var(--font-mono);
  letter-spacing: 0.05em;
  text-transform: uppercase;
}

/* --- Prose & Link Styling --- */
.prose a {
  @apply text-blueprint-blue hover:opacity-80 font-bold dark:font-extrabold;
}

.prose a:hover {
  text-decoration: underline;
  text-underline-offset: 4px;
}

.prose a.internal-link {
  @apply no-underline transition-all;
  display: inline;
}

.prose a.internal-link[data-stage="seed"] { @apply text-slate-900 dark:text-white; }
.prose a.internal-link[data-stage="sprout"] { @apply text-slate-900 dark:text-white; }
.prose a.internal-link[data-stage="evergreen"] { @apply text-slate-900 dark:text-white; }

.prose a.external-link {
  @apply font-display font-semibold text-[#a855f7] hover:opacity-80 transition-opacity inline-flex items-center gap-1 no-underline;
}

.prose a.external-link::after {
  content: "north_east";
  font-family: "Material Symbols Outlined";
  font-size: 16px;
  line-height: 1;
  @apply ml-0 opacity-100;
}

.prose code:not(pre code) {
  @apply bg-slate-100 px-1.5 py-0.5 rounded text-sm font-mono font-medium;
  color: var(--color-terminal-dark);
}

.dark .prose code:not(pre code) {
  @apply bg-slate-900;
  color: var(--color-neutral-text-dark);
}

.prose code:not(pre code)::before,
.prose code:not(pre code)::after {
  content: none;
}

/* --- Refined Callouts (Editorial In-Column Style) --- */

.prose .markdown-alert {
  display: grid !important;
  grid-template-columns: 140px 1fr !important;
  gap: 0 !important;
  background: transparent !important;
  border: none !important;
  padding: 0 !important;
  margin: 3.5rem 0 !important;
  overflow: visible !important;
  width: 100% !important;
}

/* Aggressive reset for all blockquote-related decorations from Typography plugin */
.prose .markdown-alert::before, 
.prose .markdown-alert::after,
.prose .markdown-alert blockquote::before, 
.prose .markdown-alert blockquote::after,
.prose .markdown-alert p::before,
.prose .markdown-alert p::after {
  content: none !important;
}

.prose .markdown-alert .margin-anchor {
  grid-column: 1 !important;
  padding-right: 2rem !important;
  display: flex !important;
  flex-direction: column !important;
  align-items: flex-end !important;
  justify-content: flex-start !important;
  padding-top: 4px !important;
}

.prose .markdown-alert .callout-icon {
  font-family: 'Material Symbols Outlined' !important;
  font-size: 24px !important;
  font-weight: normal !important;
  font-style: normal !important;
  line-height: 1 !important;
  display: inline-block !important;
  margin-bottom: 4px !important;
  color: var(--alert-color, #475569) !important;
}

.prose .markdown-alert .callout-label {
  font-family: var(--font-mono) !important;
  font-size: 11px !important;
  font-weight: 800 !important;
  text-transform: uppercase !important;
  letter-spacing: 0.1em !important;
  line-height: 1 !important;
  text-align: right !important;
  display: block !important;
  color: var(--alert-color, #475569) !important;
}

.prose .markdown-alert .markdown-alert-content {
  grid-column: 2 !important;
  border-left: 4px solid var(--alert-color, #475569) !important;
  padding-left: 1.75rem !important;
  min-width: 0 !important;
}

.prose .markdown-alert .markdown-alert-content p {
  margin: 0 0 1.25rem 0 !important;
  font-family: Georgia, serif !important;
  font-style: italic !important;
  font-size: 1.15rem !important;
  line-height: 1.75 !important;
  @apply text-slate-700 dark:text-slate-300;
}

.prose .markdown-alert .markdown-alert-content p:last-child {
  margin-bottom: 0 !important;
}

/* Color Mappings - Based on provided sample codes */
.markdown-alert-note, .markdown-alert-quote, .markdown-alert-draft { --alert-color: #475569; }
.dark .markdown-alert-note, .dark .markdown-alert-quote, .dark .markdown-alert-draft { --alert-color: #94a3b8; }

.markdown-alert-abstract, .markdown-alert-tip, .markdown-alert-success, .markdown-alert-summary { --alert-color: #2d5a27; }
.dark .markdown-alert-abstract, .dark .markdown-alert-tip, .dark .markdown-alert-success, .dark .markdown-alert-summary { --alert-color: #4ade80; }

.markdown-alert-info, .markdown-alert-todo, .markdown-alert-tldr { --alert-color: #1e3a8a; }
.dark .markdown-alert-info, .dark .markdown-alert-todo, .dark .markdown-alert-tldr { --alert-color: #60a5fa; }

.markdown-alert-important, .markdown-alert-error, .markdown-alert-bug, .markdown-alert-failure { --alert-color: #be123c; }
.dark .markdown-alert-important, .dark .markdown-alert-error, .dark .markdown-alert-bug, .dark .markdown-alert-failure { --alert-color: #fb7185; }

.markdown-alert-warning, .markdown-alert-caution { --alert-color: #b45309; }
.dark .markdown-alert-warning, .dark .markdown-alert-caution { --alert-color: #facc15; }

.markdown-alert-example, .markdown-alert-question { --alert-color: #7e22ce; }
.dark .markdown-alert-example, .dark .markdown-alert-question { --alert-color: #c084fc; }

/* --- Filter Buttons --- */
.filter-btn {
  @apply px-3 py-1.5 text-sm font-medium transition-all;
  font-family: var(--font-mono);
  font-size: 11px;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  color: #737373;
  background: transparent;
  border: none;
  @apply dark:text-slate-400;
}

.filter-btn:hover {
  color: #262626;
  @apply dark:text-slate-200;
}

.filter-btn.active {
  color: #1a1a1a;
  border-bottom: 1px solid #1a1a1a;
  @apply dark:text-white dark:border-white;
}
